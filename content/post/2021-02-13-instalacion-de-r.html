---
title: Instalación de R
author: Rubén Fernández Casal
date: '2021-02-13'
slug: instalacion-de-r
categories:
  - R
tags:
  - Configuración
  - Apuntes
summary: "Pasos para la instalación de R en Windows, Ubuntu/Devian y Mac OS X."
output:
  blogdown::html_page:
    toc: true
---


<div id="TOC">
<ul>
<li><a href="#windows">Instalación de R en Windows</a><ul>
<li><a href="#asistente-de-instalación">Asistente de instalación</a></li>
<li><a href="#instalación-de-paquetes">Instalación de paquetes</a></li>
<li><a href="#ide">Instalación (opcional) de un entorno de desarrollo o un editor de comandos</a></li>
<li><a href="#configuración-avanzada-opcional">Configuración avanzada (opcional)</a><ul>
<li><a href="#library">Cambiar los permisos de la carpeta <em>library</em></a></li>
<li><a href="#rtools">Instalación de Rtools y configuración de la ruta de búsqueda</a></li>
</ul></li>
</ul></li>
<li><a href="#ubuntu">Instalación de R en Ubuntu/Devian</a><ul>
<li><a href="#instalación-de-r-desde-cran">Instalación de R desde <span>CRAN</span></a></li>
<li><a href="#instalación-de-devtools-y-demás-paquetes">Instalación de devtools y demás paquetes</a></li>
<li><a href="#ayuda-html">Ayuda html</a></li>
<li><a href="#actualizar-r">Actualizar R</a></li>
<li><a href="#instalar-r-studio">Instalar R-Studio</a></li>
</ul></li>
<li><a href="#macosx">Instalación en Mac OS X</a></li>
</ul>
</div>

<p>En la web del proyecto R (<a href="http://www.r-project.org">www.r-project.org</a>) está disponible mucha información sobre este entorno estadístico.</p>
<table>
<tbody>
<tr class="odd">
<td align="center"><a href="https://r-project.org">R-project</a></td>
<td align="center"><a href="https://cran.r-project.org">CRAN</a></td>
</tr>
<tr class="even">
<td align="center"><img src="/img/rproject.png" /></td>
<td align="center"><img src="/img/cran.png" style="width:88.0%" /></td>
</tr>
</tbody>
</table>
<p>Las descargas se realizan a través de la web del CRAN (The Comprehensive R Archive Network), con múltiples <a href="https://cran.r-project.org/mirrors.html">mirrors</a>:</p>
<ul>
<li><em>Oficina de Software Libre (A Coruña)</em> (CIXUG): <a href="http://ftp.cixug.es/CRAN/">ftp.cixug.es/CRAN</a>.</li>
<li><em>Spanish National Research Network (Madrid)</em> (RedIRIS): <a href="http://cran.es.r-project.org/">cran.es.r-project.org</a>.</li>
</ul>
<div id="windows" class="section level1">
<h1>Instalación de R en Windows</h1>
<p>Seleccionando <a href="http://ftp.cixug.es/CRAN/bin/windows/">Download R for Windows</a> y posteriormente <a href="http://ftp.cixug.es/CRAN/bin/windows/base/">base</a> accedemos al enlace con el instalador de R para Windows (actualmente de la versión <a href="http://ftp.cixug.es/CRAN/bin/windows/base/R-4.0.3-win.exe">4.0.3</a>).</p>
<p><img src="/img/R351.png" style="width:60.0%" /></p>
<div id="asistente-de-instalación" class="section level2">
<h2>Asistente de instalación</h2>
<p>Durante el proceso de instalación la recomendación (para evitar posibles problemas) es seleccionar ventanas simples SDI en lugar de múltiples ventanas MDI (hay que utilizar <em>Opciones de configuración</em>).</p>
<p><img src="/img/asistente.png" style="width:70.0%" /></p>
<p>Una vez terminada la instalación, al abrir R aparece la ventana de la consola (simula una ventana de comandos de Unix) que permite ejecutar comandos de R.</p>
<p>Por defecto se instalan un conjunto de paquetes base de R (que se cargan automáticamente al iniciarlo) y un conjunto de <a href="https://cran.r-project.org/src/contrib/4.0.3/Recommended">paquetes recomendados</a> (que se pueden cargar empleando el comando <code>library()</code>),
pero hay disponibles miles de paquetes que cubren literalmente todos los campos del análisis de datos.
Ver por ejemplo:</p>
<ul>
<li><p><a href="https://cran.r-project.org/web/packages/index.html">CRAN: Packages</a></p></li>
<li><p><a href="https://cran.r-project.org/web/views">CRAN: Task Views</a></p></li>
</ul>
</div>
<div id="instalación-de-paquetes" class="section level2">
<h2>Instalación de paquetes</h2>
<p>Después de la instalación de R suele ser necesario instalar paquetes adicionales (puede ser recomendable <em>Ejecutar como administrador</em> R para evitar problemas de permiso de escritura en la carpeta <em>C:\Program Files\R\R-X.Y.Z\library</em>, o cambiar previamente los permisos de esta carpeta como se indica <a href="#library">aquí</a>).</p>
<p>Los paquetes que recomendaría instalar a un usuario que se está iniciando en R son <a href="https://socialsciences.mcmaster.ca/jfox/Misc/Rcmdr"><code>Rcmdr</code></a> y <a href="https://rattle.togaware.com"><code>rattle</code></a> (dos entornos gráficos), junto con sus dependencias (de esta forma cubriríamos las herramientas necesarias para la mayoría de análisis con R).
Para ello bastaría con ejecutar en la consola de R (copiando y pegando p.e.) los comandos:</p>
<pre class="r"><code>pkgs &lt;- c(&quot;Rcmdr&quot;, &quot;rattle&quot;) # Añadir los que se deseen...
install.packages(pkgs, dependencies = TRUE)</code></pre>
<p>(puede que haya que seleccionar el repositorio de descarga, e.g. <em>Spain (Madrid)</em>).</p>
<p>La forma tradicional es esta:</p>
<ol style="list-style-type: decimal">
<li><p>Se inicia R y se selecciona <em>Paquetes &gt; Instalar paquetes</em></p></li>
<li><p>Se selecciona el repositorio.</p></li>
<li><p>Se selecciona el paquete y automáticamente se instala.</p></li>
</ol>
<p>El problema con esta forma es que no se instalan todos los paquetes de los que dependen (el <code>Rcmdr</code> lo hace automáticamente al iniciarlo por primera vez con el comando <code>library(Rcmdr)</code>).</p>
<p><code>Rattle</code> depende de la libraría gráfica GTK+, al iniciarlo por primera vez con el comando <code>library(rattle)</code> nos pregunta si queremos instalarla:</p>
<p><img src="/img/image7.png" style="width:30.0%" /></p>
<p>Pulsamos OK y reiniciamos R.</p>
<p>En el caso de un usuario más avanzado, puede ser recomendable preparar un listado de todos los paquetes que se requieren y ejecutar un código de la forma:</p>
<pre class="r"><code>pkgs &lt;- c(&quot;mgcv&quot;, &quot;car&quot;, &quot;leaps&quot;, &quot;lmtest&quot;, &quot;glmnet&quot;, &quot;RcmdrMisc&quot;, 
          &quot;rmarkdown&quot;, &quot;knitr&quot;, &quot;ggplot2&quot;, &quot;dplyr&quot;, &quot;dbplyr&quot;, &quot;tidyr&quot;, 
          &quot;stringr&quot;, &quot;readxl&quot;, &quot;openxlsx&quot;)
install.packages(setdiff(pkgs, installed.packages()[,&quot;Package&quot;]), dependencies = TRUE)</code></pre>
<p>El código anterior no reinstala los paquetes ya instalados, por lo que podrían aparecer problemas debidos a incompatibilidades entre versiones (aunque no suele ocurrir, salvo que nuestra instalación de R esté muy desactualizada).
Si es el caso, en lugar de la última línea se puede ejecutar:</p>
<pre class="r"><code>install.packages(pkgs, dependencies = TRUE) # Instala todos...</code></pre>
<p>Listados de paquetes recomendables:</p>
<ul>
<li><p><a href="https://support.rstudio.com/hc/en-us/articles/201057987">RStudio: Quick list of useful R packages</a></p></li>
<li><p><a href="https://www.computerworld.com/article/2921176">Great R packages for data import, wrangling and visualization</a></p></li>
</ul>
<p>NOTA: Yo prefiero instalar nuevas versiones de R siguiendo los pasos anteriores, pero otra alternativa es emplear <code>installr::updateR()</code>.</p>
</div>
<div id="ide" class="section level2">
<h2>Instalación (opcional) de un entorno de desarrollo o un editor de comandos</h2>
<p>Aunque la consola de R dispone de un editor básico de código (script), puede ser recomendable trabajar con un editor de comandos más cómodo y flexible.</p>
<p>Un entorno de desarrollo (integrated development environment, IDE) muy recomendable es <a href="http://rstudio.org">RStudio</a>, que se puede instalar siguiendo los pasos en <a href="/post/instalacion-de-rstudio">este post</a>.</p>
<p>Otras alternativas son:</p>
<ul>
<li><p><a href="https://sourceforge.net/projects/tinn-r">Tinn-R: GUI for R Language and Environment</a></p></li>
<li><p><a href="https://sourceforge.net/projects/npptor">NppToR: R in Notepad++</a> (requiere <a href="https://notepad-plus-plus.org/download">Notepad++</a>)</p></li>
<li><p><a href="https://www.gnu.org/software/emacs">Emacs</a> con <a href="https://stat.ethz.ch/ESS">ESS: Emacs Speaks Statistics)</a></p></li>
<li><p><a href="http://www.eclipse.org">Eclipse</a></p></li>
<li><p><a href="https://docs.microsoft.com/en-us/visualstudio/rtvs/?view=vs-2017">Microsoft Visual Studio</a></p></li>
</ul>
</div>
<div id="configuración-avanzada-opcional" class="section level2">
<h2>Configuración avanzada (opcional)</h2>
<div id="library" class="section level3">
<h3>Cambiar los permisos de la carpeta <em>library</em></h3>
<p>Para evitar problemas con la instalación de paquetes en Windows (y evitar también que los paquetes se instalen en <em>Documentos\R\win-library\X.Y</em>) yo acostumbro a dar permiso de <em>control total</em> a los usuarios del equipo en el subdirectorio <em>library</em> de la instalación de R.
Para ello, pulsar con el botón derecho en esta carpeta (e.g. <em>C:\Program Files\R\R-4.0.3\library</em>), seleccionar <em>Propiedades &gt; Seguridad &gt; Editar</em>, seleccionar los <em>Usuarios</em> del equipo, marcar <em>Control total</em> y <em>Aplicar</em>.</p>
<table>
<tbody>
<tr class="odd">
<td align="center"><img src="/img/propiedades.png" /></td>
<td align="center"><img src="/img/permisos.png" /></td>
</tr>
</tbody>
</table>
</div>
<div id="rtools" class="section level3">
<h3>Instalación de Rtools y configuración de la ruta de búsqueda</h3>
<p>Para instalar paquetes a partir del código en Windows (y por tanto para desarrollar nuevos paquetes) puede ser necesario instalar <a href="https://cran.r-project.org/bin/windows/Rtools">Rtools</a> (si el paquete contiene código en C, C++ o Fortran, algo bastante habitual).
Es importante instalar la versión correspondiente a la instalación de R.</p>
<p>Al finalizar se debe añadir el directorio de instalación a la ruta de búsqueda<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>, y ya de paso recomiendo añadir también el directorio de instalación de R (de esta forma también podremos emplear R en la ventana de comandos).
Para ello habría que ir a <em>Propiedades del sistema &gt; Opciones avanzadas &gt; Variables de entorno</em> y en <em>Variables de sistema</em> editar el <em>Path</em> y añadir dos nuevas entradas (o modificar versiones anteriores):
<em>C:\rtools40\usr\bin</em> y <em>C:\Program Files\R\R-4.0.3\bin</em> (o los correspondientes directorios de instalación).</p>
<p>Si no sabes como acceder a <em>Propiedades del sistema</em> (en Windows 10 está bastante oculto) puedes consultar este <a href="https://answers.microsoft.com/es-es/windows/forum/windows_10-other_settings/windows-10-variables-de-entorno-windows-10-version/703ea5fa-1db4-46da-8ff7-6261140bf58b">post</a>.
Yo prefiero pulsar con el botón derecho en <em>Equipo</em>, seleccionar <em>Propiedades</em> y después <em>Configuración avanzada del sistema</em>.</p>
<p><img src="/img/cmd.png" style="width:60.0%" /></p>
<p>Adicionalmente, si se instaló RStudio, como también instala <a href="https://pandoc.org">pandoc</a>, se puede añadir <em>C:\Program Files\RStudio\bin\pandoc</em> al <em>Path</em> (de esta forma podremos convertir fácilmente contenido escrito en otros formatos a Markdown, ver <a href="https://rubenfcasal.github.io/bookdown_intro/pandoc.html">enlace</a>).
Al finalizar, habrá que reiniciar el equipo para que los cambios surjan efecto.</p>
<p>Si se quieren instalar paquetes de repositorios distintos de CRAN (GitHub, GitLab, Bitbucket, …), puede ser recomendable instalar <a href="https://devtools.r-lib.org"><code>devtools</code></a>,
Para más detalles ver:</p>
<ul>
<li>R packages by Hadley Wickham
(<a href="http://r-pkgs.had.co.nz/">online</a>,
<a href="http://shop.oreilly.com/product/0636920034421.do">O’Reilly</a>)</li>
</ul>
<hr />
</div>
</div>
</div>
<div id="ubuntu" class="section level1">
<h1>Instalación de R en Ubuntu/Devian</h1>
<p>Instalar dependencias:</p>
<pre class="sh"><code>sudo apt install libcurl4-gnutls-dev libgit2-dev libxml2-dev libssh2-1-dev libssl-dev git build-essential gfortran</code></pre>
<p>Si aparecen problemas asegurarse de que los repositorios <em>universe</em> y <em>multiverse</em> están disponibles:</p>
<pre class="sh"><code>sudo add-apt-repository universe
sudo add-apt-repository multiverse
sudo apt update</code></pre>
<p>Se puede instalar R desde estos repositorios, pero normalmente no será la versión más actualizada y no lo recomendaría.</p>
<div id="instalación-de-r-desde-cran" class="section level2">
<h2>Instalación de R desde <a href="https://cran.r-project.org/bin/linux/ubuntu">CRAN</a></h2>
<p>Añadir los repositorios a la lista de fuentes (para ver la versión de ubuntu se puede ejecutar <code>lsb_release -a</code>, el siguiente código ya la obtiene directamente), la llave apt e instalar R:</p>
<pre class="sh"><code>echo &quot;deb https://cloud.r-project.org/bin/linux/ubuntu/ $(lsb_release -cs)-cran35/&quot; | sudo tee /etc/apt/sources.list.d/cran-r.list
sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 51716619E084DAB9
sudo apt-get update
sudo apt-get install r-base r-base-dev</code></pre>
</div>
<div id="instalación-de-devtools-y-demás-paquetes" class="section level2">
<h2>Instalación de devtools y demás paquetes</h2>
<p>Ejecutar R en modo administrador para que los paquetes que se instalen estén disponibles para todos los usuarios</p>
<pre class="sh"><code>sudo -i R</code></pre>
<p>Ejecutar en la consola de R</p>
<pre class="r"><code>install.packages(&#39;devtools&#39;, dependencies = TRUE)</code></pre>
<p>Si aparecen problemas mirar
<a href="http://stackoverflow.com/a/20924082">stackoverflow - Problems installing the devtools package</a></p>
</div>
<div id="ayuda-html" class="section level2">
<h2>Ayuda html</h2>
<p>Si queremos la ayuda html (en un entorno gráfico con un navegador web instalado):</p>
<pre class="sh"><code>echo &quot;options(help_type=&#39;html&#39;)&quot; | sudo tee -a /etc/R/Rprofile.site</code></pre>
</div>
<div id="actualizar-r" class="section level2">
<h2>Actualizar R</h2>
<pre class="sh"><code>sudo apt-get update
sudo apt-get upgrade</code></pre>
</div>
<div id="instalar-r-studio" class="section level2">
<h2>Instalar R-Studio</h2>
<p>Si se dispone de un entorno gráfico se pueden seguir los pasos en <a href="/post/instalacion-de-rstudio/#ubuntu">este post</a> para instalar R-Studio Desktop. En caso contrario puede ser recomendable instalar R-Studio Server como se describe en <a href="/post/instalacion-de-r-para-hpc/#rstudio-server">este post</a>.</p>
<hr />
</div>
</div>
<div id="macosx" class="section level1">
<h1>Instalación en Mac OS X</h1>
<p>Instalar R de <a href="http://cran.es.r‐project.org/bin/macosx" class="uri">http://cran.es.r‐project.org/bin/macosx</a> siguiendo los pasos habituales.</p>
<p>Para instalar R-Commander (<a href="https://socialsciences.mcmaster.ca/jfox/Misc/Rcmdr/installation-notes.html" class="uri">https://socialsciences.mcmaster.ca/jfox/Misc/Rcmdr/installation-notes.html</a>) es necesario disponer de las librerías gráficas X11, como a partir de OS X Lion ya no están instaladas por defecto en el sistema, hay que instalar las librerías Open Source XQuartz <a href="https://www.xquartz.org" class="uri">https://www.xquartz.org</a>.</p>
<p>Finalmente, para instalar <code>Rcmdr</code> ejecutar en la consola de R:</p>
<pre class="r"><code>install.packages(&quot;Rcmdr&quot;, dependencies = TRUE)</code></pre>
<p>Para instalar <code>rattle</code> seguir estos pasos (<a href="https://zhiyzuo.github.io/installation-rattle" class="uri">https://zhiyzuo.github.io/installation-rattle</a>):</p>
<ol style="list-style-type: decimal">
<li><p>Instalar Homebrew:
<a href="https://brew.sh/" class="uri">https://brew.sh/</a>.</p></li>
<li><p>Ejecutar el siguiente código en la consola:</p>
<pre class="r"><code>system(&#39;brew install gtk+&#39;)

local({
  if (Sys.info()[[&#39;sysname&#39;]] != &#39;Darwin&#39;) return()

  .Platform$pkgType = &#39;mac.binary.el-capitan&#39;
  unlockBinding(&#39;.Platform&#39;, baseenv())
  assign(&#39;.Platform&#39;, .Platform, &#39;package:base&#39;)
  lockBinding(&#39;.Platform&#39;, baseenv())

  options(
    pkgType = &#39;both&#39;, install.packages.compile.from.source = &#39;always&#39;,
    repos = &#39;https://macos.rbind.org&#39;
  )
})

install.packages(c(&#39;RGtk2&#39;, &#39;cairoDevice&#39;, &#39;rattle&#39;))</code></pre></li>
</ol>
<hr />
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>Esto se puede hacer mediante el archivo <em>.Renviron</em> como se indica en la <a href="https://cran.r-project.org/bin/windows/Rtools/#putting-rtools-on-the-path">documentación oficial</a>, pero solo sería válido en R.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
